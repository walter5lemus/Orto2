{% extends 'base/base.html' %}

{% block title %}
	Editar
{% endblock %}
{% block header %}
{% endblock %}

{% block navbar %}
		<div class="bs-docs-section clearfix">
		    <div class="row">
		        <div class="col-lg-12">
		            <div class="bs-component">
		            	<nav class="navbar navbar-default">
		                	<div class="container-fluid">
		                  		<div class="navbar-header">
		                    		<a class="navbar-brand" href="http://localhost:8000/">SOUES</a>
		                  		</div>
		                  		
		                  		<ul class="nav navbar-nav navbar-right">
		                        	<li class="">
		                        		<a href="{%url 'logout' %}" role="button" aria-expanded="false">Cerrar Sesi√≥n<span></span></a>
		                        		
		                      		</li>
		                    	</ul>
		                    	<div>	
		                    	<ul class="nav navbar-nav navbar-right">
		                        	<li class="">
		                        		<a href="#" class="navbar-brand" role="button" aria-expanded="false">{{user}}<span></span></a>
		                      		</li>
		                    	</ul>
		                    	</div>
		                  		<h1 style="color:white "> <center> </center></h1> 
		                  		<h2 style="color:white "> <center>  </center></h2> 
		                  		

		                </div>
		            </nav>
		        </div>
           	</div>
        </div>
    </div>   
    {% endblock %} 


{% block content %}
<form method="POST">
	{% csrf_token %}
	
		<div class="row">
		{% if form.errors %}
		    {% for field in form %}
		        {% for error in field.errors %}
		            <div class="alert alert-danger">
		                <strong>{{ error|escape }}</strong>
		            </div>
		        {% endfor %}
		    {% endfor %}
		    {% for error in form.non_field_errors %}
		        <div class="alert alert-danger">
		            <strong>{{ error|escape }}</strong>
		        </div>
		    {% endfor %}
		{% endif %}
		</div>

</form>

<div class="col-md-10 col-md-offset-1">
<div class="panel panel-primary">
  <div class="panel-heading">
    <h3 class="panel-title"></h3>
  </div>

  <div class="panel-body">
    <br><br>
	<div class="col-md-6 col-md-offset-3">
		<div class="form-group">
			<label for="{{form.cod_expediente.name}}">{{form.cod_expediente.label}}</label>	
		{{form.cod_expediente}}
		<button class="btn btn-primary" onclick="buscar()">Buscar</button>
		</div>
	</div>

	<div class="col-md-6 col-md-offset-3">
		<div class="form-group" >
			<label for="ficha">Ficha</label>	
		<select name="select" id="select" class="form-control"></select>
		</div>
	</div>

	<div class="col-md-8 col-md-offset-2">
		<div class="form-group">
			<center>	<button type="submit" onclick="redireccionar()" class="btn btn-success">Actualizar expediente</button></center>
		</div>
	</div>

  </div>
</div>




<div class="col-md-6 col-md-offset-8">
<div class="alert alert-dismissible alert-warning">
  <button class="close" type="button" data-dismiss="alert">&times;</button>
  <h4>Indicacion!</h4>
  <p>Para actualizar una ficha clinica de un expediente existente, <a class="alert-link" href="#">debes ingresar el codigo del expediente</a>, y luego seleccionar la ficha clinica a modificar.</p>
</div>
</div>


</div>


<script>

	function buscar(){

		var codigo = $('#id_codigo').val();

		$.ajax({
			data : {'codigo':codigo},
			url : '/reportes/numero/'+codigo+'/',
			type : 'get',
			success: function(data){
				for (var i = 0; i < data.length; i++) {
					
					$("#select").append('<option value='+(i+1)+'>'+data[i].fields.numero+'</option>');
				}
				if (data.length==0) {
					
					$('#select').empty();
				}
			}
		});

	}

	function redireccionar(){

		var codigo = $('#id_codigo').val();
		var numero = $('#select').val();
		location.href='/informacion/motivo_consultas/nuevo/'+codigo+'/'+numero+'/'	; 
		$('#id_codigo').val("");
		$('#nombre').val("");
		$('#id_numero').empty();id_codigo
		}
</script>
{% endblock %}